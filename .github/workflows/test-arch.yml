on: [push]

jobs:
  build:
    runs-on: ubuntu-20.04
    name: Build on Aarch64
    steps:
      - uses: actions/checkout@main
      - uses: uraimo/run-on-arch-action@v2.1.0
        id: runcmd
        with:
          arch: aarch64
          distro: ubuntu20.04
          run: |
            uname -a
            apt-get -y update
            apt-get -y upgrade
            apt-get -y install libreadline-dev libconfig-dev libssl-dev lua5.2 liblua5.2-dev libevent-dev libjansson-dev libpython3-dev make git
            git clone --recursive https://github.com/vysheng/tg.git && cd tg
            ./configure && make
            
            echo ::set-output name=uname::$(uname -a)
      - name: Get the output
        run: |
            echo "The uname output was ${{ steps.runcmd.outputs.uname }}"
